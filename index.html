<html  ng-app="pollApp">
<head>
  <title>AngularJS et Socket.io en pratique !</title>

  <!-- Librairies javascript -->
  <script src="/js/socket.io-1.3.7.js"></script>
  <script src="/js/angular.min.js"></script>
  <script src="/js/Chart.min.js"></script>
  <script src="/js/angular-chart.min.js"></script>

  <!-- Controlleur du sondage -->
  <script src="/ctrl/poll.js"></script>

  <!-- Feuille de style pour les graphiques -->
  <link rel="stylesheet" href="/css/angular-chart.min.css">
</head>
<body ng-controller="pollCtrl" onload="main()">

  <!-- Boutons de réponse -->
  <button onclick="send(0)">yes</button>
  <button onclick="send(1)">no</button>
  <button onclick="send(2)">maybe</button>

  <!-- Graphique -->
  <div ng-if="chartData">
    <canvas id="chart" class="chart chart-doughnut"
      chart-data="chartData"
      chart-labels="chartLabels"
      chart-legend="true"></canvas>
  </div>

  <script>

    /**
     * Fonction d'initialisation
     */
    function main() {
      var socket = io.connect('http://localhost:1337');
      socket.emit('poll-request');
    }

    /**
     * Envoie une réponse
     * @param index de la réponse
     */
    function send(s) {
      var socket = io.connect('http://localhost:1337');
      socket.emit('send', s);
    }

  </script>
</body>
</html>
